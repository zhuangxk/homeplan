"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var app = getApp();
var index_1 = require("../../../api/index");
Component({
    data: {
        show: false,
        CustomBar: app.globalData.CustomBar,
        bills: [],
        loading: false,
        complete: false,
        total: 0,
        params: {
            "page": 1,
            "page_size": 20
        }
    },
    properties: {
        ledgerId: {
            type: Number
        }
    },
    lifetimes: {
        ready: function () {
            this.getBills();
        }
    },
    observers: {
        ledgerId: function () {
            this.getBills();
        }
    },
    methods: {
        getBills: function () {
            var _this = this;
            if (!this.data.ledgerId) {
                return;
            }
            if (this.data.loading || this.data.complete) {
                return;
            }
            this.data.loading = true;
            wx.showLoading({
                title: '加载中'
            });
            index_1.getBills(this.data.ledgerId, this.data.params).then(function (res) {
                var bills = _this.data.bills;
                bills.concat(res.list);
                _this.setData({
                    bills: bills.concat(res.list),
                    total: res.total
                });
                wx.hideLoading();
                _this.data.loading = false;
                if (_this.data.bills.length >= _this.data.total) {
                    _this.data.complete = true;
                }
            });
        },
        onAdd: function () {
            this.setData({
                show: true
            });
        },
        onClose: function () {
            this.setData({
                show: false
            });
        },
        onSave: function () {
            this.setData({
                show: false
            });
            this.data.params.page = 1;
            this.data.bills = [];
            this.getBills();
        },
        onScrollLower: function () {
            this.data.params.page++;
            this.getBills();
        },
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlsbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImJpbGwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNLEdBQUcsR0FBRyxNQUFNLEVBQWdCLENBQUE7QUFDbEMsNENBQTZDO0FBQzdDLFNBQVMsQ0FBQztJQUNOLElBQUksRUFBRTtRQUNGLElBQUksRUFBRSxLQUFLO1FBQ1gsU0FBUyxFQUFFLEdBQUcsQ0FBQyxVQUFVLENBQUMsU0FBUztRQUNuQyxLQUFLLEVBQUUsRUFBYztRQUNyQixPQUFPLEVBQUUsS0FBSztRQUNkLFFBQVEsRUFBRSxLQUFLO1FBQ2YsS0FBSyxFQUFFLENBQUM7UUFDUixNQUFNLEVBQUU7WUFDSixNQUFNLEVBQUUsQ0FBQztZQUNULFdBQVcsRUFBRSxFQUFFO1NBQ2xCO0tBQ0o7SUFDRCxVQUFVLEVBQUU7UUFDUixRQUFRLEVBQUU7WUFDTixJQUFJLEVBQUUsTUFBTTtTQUNmO0tBQ0o7SUFDRCxTQUFTLEVBQUU7UUFDUCxLQUFLLEVBQUw7WUFDRSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDakIsQ0FBQztLQUNKO0lBQ0QsU0FBUyxFQUFFO1FBQ1AsUUFBUSxFQUFSO1lBQ0ksSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFBO1FBQ25CLENBQUM7S0FDSjtJQUNELE9BQU8sRUFBRTtRQUNMLFFBQVEsRUFBUjtZQUFBLGlCQXdCQztZQXZCRyxJQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUM7Z0JBQ25CLE9BQU07YUFDVDtZQUNELElBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUM7Z0JBQ3ZDLE9BQU07YUFDVDtZQUNELElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQTtZQUN4QixFQUFFLENBQUMsV0FBVyxDQUFDO2dCQUNYLEtBQUssRUFBRSxLQUFLO2FBQ2YsQ0FBQyxDQUFBO1lBQ0YsZ0JBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFBLEdBQUc7Z0JBQzNDLElBQUEsd0JBQUssQ0FBYztnQkFDM0IsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUE7Z0JBQ3RCLEtBQUksQ0FBQyxPQUFPLENBQUM7b0JBQ1QsS0FBSyxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQztvQkFDN0IsS0FBSyxFQUFFLEdBQUcsQ0FBQyxLQUFLO2lCQUNuQixDQUFDLENBQUE7Z0JBQ0YsRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFBO2dCQUNoQixLQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUE7Z0JBQ3pCLElBQUcsS0FBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxJQUFJLEtBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFDO29CQUN6QyxLQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUE7aUJBQzVCO1lBQ0wsQ0FBQyxDQUFDLENBQUE7UUFDTixDQUFDO1FBQ0QsS0FBSyxFQUFMO1lBQ0ksSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDVCxJQUFJLEVBQUUsSUFBSTthQUNiLENBQUMsQ0FBQTtRQUNOLENBQUM7UUFFRCxPQUFPLEVBQVA7WUFDSSxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNULElBQUksRUFBRSxLQUFLO2FBQ2QsQ0FBQyxDQUFBO1FBQ04sQ0FBQztRQUVELE1BQU0sRUFBTjtZQUNJLElBQUksQ0FBQyxPQUFPLENBQUM7Z0JBQ1QsSUFBSSxFQUFFLEtBQUs7YUFDZCxDQUFDLENBQUE7WUFDRixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEdBQUMsQ0FBQyxDQUFBO1lBQ3ZCLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQTtZQUNwQixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDbkIsQ0FBQztRQUVELGFBQWEsRUFBYjtZQUNJLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFBO1lBQ3ZCLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQTtRQUNuQixDQUFDO0tBQ0o7Q0FFSixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBhcHAgPSBnZXRBcHAoKSBhcyBJQXBwT3B0aW9uXHJcbmltcG9ydCB7IGdldEJpbGxzIH0gZnJvbSBcIi4uLy4uLy4uL2FwaS9pbmRleFwiXHJcbkNvbXBvbmVudCh7XHJcbiAgICBkYXRhOiB7XHJcbiAgICAgICAgc2hvdzogZmFsc2UsXHJcbiAgICAgICAgQ3VzdG9tQmFyOiBhcHAuZ2xvYmFsRGF0YS5DdXN0b21CYXIsXHJcbiAgICAgICAgYmlsbHM6IFtdIGFzIEFueUFycmF5LFxyXG4gICAgICAgIGxvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcclxuICAgICAgICB0b3RhbDogMCxcclxuICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgXCJwYWdlXCI6IDEsXHJcbiAgICAgICAgICAgIFwicGFnZV9zaXplXCI6IDIwXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICBsZWRnZXJJZDoge1xyXG4gICAgICAgICAgICB0eXBlOiBOdW1iZXJcclxuICAgICAgICB9ICBcclxuICAgIH0sXHJcbiAgICBsaWZldGltZXM6IHtcclxuICAgICAgICByZWFkeSgpOiB2b2lke1xyXG4gICAgICAgICAgdGhpcy5nZXRCaWxscygpICBcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb2JzZXJ2ZXJzOiB7XHJcbiAgICAgICAgbGVkZ2VySWQoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0QmlsbHMoKSBcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgbWV0aG9kczoge1xyXG4gICAgICAgIGdldEJpbGxzKCk6IHZvaWR7XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLmRhdGEubGVkZ2VySWQpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYodGhpcy5kYXRhLmxvYWRpbmcgfHwgdGhpcy5kYXRhLmNvbXBsZXRlKXtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5sb2FkaW5nID0gdHJ1ZVxyXG4gICAgICAgICAgICB3eC5zaG93TG9hZGluZyh7XHJcbiAgICAgICAgICAgICAgICB0aXRsZTogJ+WKoOi9veS4rSdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgZ2V0QmlsbHModGhpcy5kYXRhLmxlZGdlcklkLCB0aGlzLmRhdGEucGFyYW1zKS50aGVuKHJlcz0+e1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeyBiaWxscyB9ID0gdGhpcy5kYXRhXHJcbiAgICAgICAgICAgICAgICBiaWxscy5jb25jYXQocmVzLmxpc3QpXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgICAgICAgICAgICAgIGJpbGxzOiBiaWxscy5jb25jYXQocmVzLmxpc3QpLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsOiByZXMudG90YWxcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB3eC5oaWRlTG9hZGluZygpXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEubG9hZGluZyA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmRhdGEuYmlsbHMubGVuZ3RoID49IHRoaXMuZGF0YS50b3RhbCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLmNvbXBsZXRlID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb25BZGQoKTogdm9pZHtcclxuICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgIHNob3c6IHRydWVcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gIFxyXG4gICAgICAgIG9uQ2xvc2UoKTogdm9pZHtcclxuICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgIHNob3c6IGZhbHNlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgb25TYXZlKCk6IHZvaWR7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICBzaG93OiBmYWxzZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB0aGlzLmRhdGEucGFyYW1zLnBhZ2U9MVxyXG4gICAgICAgICAgICB0aGlzLmRhdGEuYmlsbHMgPSBbXVxyXG4gICAgICAgICAgICB0aGlzLmdldEJpbGxzKClcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvblNjcm9sbExvd2VyKCk6IHZvaWR7XHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wYXJhbXMucGFnZSsrXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0QmlsbHMoKVxyXG4gICAgICAgIH0sXHJcbiAgICB9XHJcblxyXG59KVxyXG5cclxuZXhwb3J0IHsgfVxyXG5cclxuIl19