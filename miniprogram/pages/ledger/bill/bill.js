"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var app = getApp();
var index_1 = require("../../../api/index");
Component({
    data: {
        show: false,
        CustomBar: app.globalData.CustomBar,
        bills: [],
        dayBills: [],
        loading: false,
        complete: false,
        total: 0,
        params: {
            "page": 1,
            "page_size": -1
        }
    },
    properties: {
        ledgerId: {
            type: Number
        }
    },
    lifetimes: {
        ready: function () {
            this.getBills();
        }
    },
    observers: {
        ledgerId: function () {
            this.getBills();
        },
        bills: function () {
            this.setData({});
        }
    },
    methods: {
        getBills: function () {
            var _this = this;
            if (!this.data.ledgerId) {
                return;
            }
            if (this.data.loading || this.data.complete) {
                return;
            }
            this.data.loading = true;
            wx.showLoading({
                title: '加载中'
            });
            index_1.getBills(this.data.ledgerId, this.data.params).then(function (res) {
                var bills = _this.data.bills;
                bills.concat(res.list);
                _this.setData({
                    bills: bills.concat(res.list),
                    total: res.total
                });
                wx.hideLoading();
                _this.data.loading = false;
                if (_this.data.bills.length >= _this.data.total) {
                    _this.data.complete = true;
                }
            });
        },
        onAdd: function () {
            this.setData({
                show: true
            });
        },
        onClose: function () {
            this.setData({
                show: false
            });
        },
        onSave: function () {
            this.setData({
                show: false
            });
            this.data.params.page = 1;
            this.data.bills = [];
            this.getBills();
        },
        onScrollLower: function () {
            this.data.params.page++;
            this.getBills();
        },
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmlsbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImJpbGwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxJQUFNLEdBQUcsR0FBRyxNQUFNLEVBQWdCLENBQUE7QUFDbEMsNENBQTZDO0FBQzdDLFNBQVMsQ0FBQztJQUNOLElBQUksRUFBRTtRQUNGLElBQUksRUFBRSxLQUFLO1FBQ1gsU0FBUyxFQUFFLEdBQUcsQ0FBQyxVQUFVLENBQUMsU0FBUztRQUNuQyxLQUFLLEVBQUUsRUFBYztRQUNyQixRQUFRLEVBQUUsRUFBYztRQUN4QixPQUFPLEVBQUUsS0FBSztRQUNkLFFBQVEsRUFBRSxLQUFLO1FBQ2YsS0FBSyxFQUFFLENBQUM7UUFDUixNQUFNLEVBQUU7WUFDSixNQUFNLEVBQUUsQ0FBQztZQUNULFdBQVcsRUFBRSxDQUFDLENBQUM7U0FDbEI7S0FDSjtJQUNELFVBQVUsRUFBRTtRQUNSLFFBQVEsRUFBRTtZQUNOLElBQUksRUFBRSxNQUFNO1NBQ2Y7S0FDSjtJQUNELFNBQVMsRUFBRTtRQUNQLEtBQUssRUFBTDtZQUNFLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQTtRQUNqQixDQUFDO0tBQ0o7SUFDRCxTQUFTLEVBQUU7UUFDUCxRQUFRLEVBQVI7WUFDSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDbkIsQ0FBQztRQUNELEtBQUssRUFBTDtZQUNJLElBQUksQ0FBQyxPQUFPLENBQUMsRUFFWixDQUFDLENBQUE7UUFDTixDQUFDO0tBQ0o7SUFDRCxPQUFPLEVBQUU7UUFDTCxRQUFRLEVBQVI7WUFBQSxpQkF3QkM7WUF2QkcsSUFBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFDO2dCQUNuQixPQUFNO2FBQ1Q7WUFDRCxJQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFDO2dCQUN2QyxPQUFNO2FBQ1Q7WUFDRCxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUE7WUFDeEIsRUFBRSxDQUFDLFdBQVcsQ0FBQztnQkFDWCxLQUFLLEVBQUUsS0FBSzthQUNmLENBQUMsQ0FBQTtZQUNGLGdCQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQSxHQUFHO2dCQUMzQyxJQUFBLHdCQUFLLENBQWM7Z0JBQzNCLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFBO2dCQUN0QixLQUFJLENBQUMsT0FBTyxDQUFDO29CQUNULEtBQUssRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUM7b0JBQzdCLEtBQUssRUFBRSxHQUFHLENBQUMsS0FBSztpQkFDbkIsQ0FBQyxDQUFBO2dCQUNGLEVBQUUsQ0FBQyxXQUFXLEVBQUUsQ0FBQTtnQkFDaEIsS0FBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFBO2dCQUN6QixJQUFHLEtBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sSUFBSSxLQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBQztvQkFDekMsS0FBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFBO2lCQUM1QjtZQUNMLENBQUMsQ0FBQyxDQUFBO1FBQ04sQ0FBQztRQUNELEtBQUssRUFBTDtZQUNJLElBQUksQ0FBQyxPQUFPLENBQUM7Z0JBQ1QsSUFBSSxFQUFFLElBQUk7YUFDYixDQUFDLENBQUE7UUFDTixDQUFDO1FBRUQsT0FBTyxFQUFQO1lBQ0ksSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDVCxJQUFJLEVBQUUsS0FBSzthQUNkLENBQUMsQ0FBQTtRQUNOLENBQUM7UUFFRCxNQUFNLEVBQU47WUFDSSxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNULElBQUksRUFBRSxLQUFLO2FBQ2QsQ0FBQyxDQUFBO1lBQ0YsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxHQUFDLENBQUMsQ0FBQTtZQUN2QixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUE7WUFDcEIsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFBO1FBQ25CLENBQUM7UUFFRCxhQUFhLEVBQWI7WUFDSSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQTtZQUN2QixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUE7UUFDbkIsQ0FBQztLQUNKO0NBRUosQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYXBwID0gZ2V0QXBwKCkgYXMgSUFwcE9wdGlvblxyXG5pbXBvcnQgeyBnZXRCaWxscyB9IGZyb20gXCIuLi8uLi8uLi9hcGkvaW5kZXhcIlxyXG5Db21wb25lbnQoe1xyXG4gICAgZGF0YToge1xyXG4gICAgICAgIHNob3c6IGZhbHNlLFxyXG4gICAgICAgIEN1c3RvbUJhcjogYXBwLmdsb2JhbERhdGEuQ3VzdG9tQmFyLFxyXG4gICAgICAgIGJpbGxzOiBbXSBhcyBBbnlBcnJheSxcclxuICAgICAgICBkYXlCaWxsczogW10gYXMgQW55QXJyYXksXHJcbiAgICAgICAgbG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgY29tcGxldGU6IGZhbHNlLFxyXG4gICAgICAgIHRvdGFsOiAwLFxyXG4gICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICBcInBhZ2VcIjogMSxcclxuICAgICAgICAgICAgXCJwYWdlX3NpemVcIjogLTFcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGxlZGdlcklkOiB7XHJcbiAgICAgICAgICAgIHR5cGU6IE51bWJlclxyXG4gICAgICAgIH0gIFxyXG4gICAgfSxcclxuICAgIGxpZmV0aW1lczoge1xyXG4gICAgICAgIHJlYWR5KCk6IHZvaWR7XHJcbiAgICAgICAgICB0aGlzLmdldEJpbGxzKCkgIFxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvYnNlcnZlcnM6IHtcclxuICAgICAgICBsZWRnZXJJZCgpOiB2b2lkIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRCaWxscygpIFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYmlsbHMoKTogdm9pZCB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XHJcblxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBtZXRob2RzOiB7XHJcbiAgICAgICAgZ2V0QmlsbHMoKTogdm9pZHtcclxuICAgICAgICAgICAgaWYoIXRoaXMuZGF0YS5sZWRnZXJJZCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZih0aGlzLmRhdGEubG9hZGluZyB8fCB0aGlzLmRhdGEuY29tcGxldGUpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kYXRhLmxvYWRpbmcgPSB0cnVlXHJcbiAgICAgICAgICAgIHd4LnNob3dMb2FkaW5nKHtcclxuICAgICAgICAgICAgICAgIHRpdGxlOiAn5Yqg6L295LitJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICBnZXRCaWxscyh0aGlzLmRhdGEubGVkZ2VySWQsIHRoaXMuZGF0YS5wYXJhbXMpLnRoZW4ocmVzPT57XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGJpbGxzIH0gPSB0aGlzLmRhdGFcclxuICAgICAgICAgICAgICAgIGJpbGxzLmNvbmNhdChyZXMubGlzdClcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgICAgICAgICAgICAgYmlsbHM6IGJpbGxzLmNvbmNhdChyZXMubGlzdCksXHJcbiAgICAgICAgICAgICAgICAgICAgdG90YWw6IHJlcy50b3RhbFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIHd4LmhpZGVMb2FkaW5nKClcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YS5sb2FkaW5nID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMuZGF0YS5iaWxscy5sZW5ndGggPj0gdGhpcy5kYXRhLnRvdGFsKXtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGEuY29tcGxldGUgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBvbkFkZCgpOiB2b2lke1xyXG4gICAgICAgICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgICAgICAgICAgc2hvdzogdHJ1ZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0sXHJcbiAgXHJcbiAgICAgICAgb25DbG9zZSgpOiB2b2lke1xyXG4gICAgICAgICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgICAgICAgICAgc2hvdzogZmFsc2VcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvblNhdmUoKTogdm9pZHtcclxuICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICAgICAgICAgIHNob3c6IGZhbHNlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5wYXJhbXMucGFnZT0xXHJcbiAgICAgICAgICAgIHRoaXMuZGF0YS5iaWxscyA9IFtdXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0QmlsbHMoKVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG9uU2Nyb2xsTG93ZXIoKTogdm9pZHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnBhcmFtcy5wYWdlKytcclxuICAgICAgICAgICAgdGhpcy5nZXRCaWxscygpXHJcbiAgICAgICAgfSxcclxuICAgIH1cclxuXHJcbn0pXHJcblxyXG5leHBvcnQgeyB9XHJcblxyXG4iXX0=