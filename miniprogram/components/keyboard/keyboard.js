"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
Component({
    options: {
        styleIsolation: 'apply-shared'
    },
    data: {
        minDate: new Date(new Date().getTime() - 1000 * 60 * 60 * 24 * 30).getTime(),
        maxDate: new Date().getTime(),
        max: 9999999,
        min: 0,
        remark: '',
        acount: '',
        date: '',
        imgPopupShow: false,
        acountPopupShow: false,
        datePopupShow: false,
        typing: false,
        MainCur: 0,
        form: {
            billTypeId: null
        },
        fileList: [],
        billTypes: [{ id: 0, name: '购物', icon: 'close' },
            { id: 1, name: '购物1', icon: 'close' },
            { id: 2, name: '购物2', icon: 'close' },
            { id: 3, name: '购物3', icon: 'close' },
            { id: 4, name: '购物4', icon: 'close' },
            { id: 5, name: '购物5', icon: 'close' },
            { id: 6, name: '购物6', icon: 'close' },
            { id: 7, name: '购物7', icon: 'close' },
            { id: 8, name: '购物8', icon: 'close' },
            { id: 9, name: '购物9', icon: 'close' },
            { id: 10, name: '购物10', icon: 'close' },
            { id: 11, name: '购物11', icon: 'close' },
            { id: 12, name: '购物12', icon: 'close' },
            { id: 13, name: '购物13', icon: 'close' },
            { id: 14, name: '购物14', icon: 'close' },
            { id: 15, name: '购物15', icon: 'close' }],
    },
    methods: {
        onInput: function (e) {
            var value = e.currentTarget.dataset.v;
            if (!value)
                return;
            switch (value) {
                case 'date':
                    this.date();
                    return;
                case 'acount':
                    this.acount();
                    return;
                case 'ok':
                    this.ok();
                    return;
                case 'del':
                    this.del();
                    wx.vibrateShort();
                    return;
                default:
                    this.input(value);
                    wx.vibrateShort();
                    return;
            }
        },
        del: function () {
            var value = this.data.acount.substring(0, this.data.acount.length - 1);
            console.log('del', value);
            this.setData({
                acount: value
            });
        },
        date: function () {
            this.setData({
                datePopupShow: true
            });
        },
        ok: function () {
            ;
        },
        acount: function () {
            this.setData({
                acountPopupShow: true
            });
        },
        input: function (val) {
            var value = this.format(val);
            this.setData({
                acount: value
            });
        },
        format: function (val) {
            if (this.data.acount.indexOf('.') > -1) {
                if (val === '.') {
                    return this.data.acount;
                }
                if (this.data.acount.split('.')[1].length >= 2) {
                    return this.data.acount;
                }
            }
            var value = this.data.acount + val;
            if (val === '.') {
                return this.data.acount + val;
            }
            if (this.data.acount === '0') {
                if (val !== '.') {
                    return val;
                }
            }
            if (parseInt(value) > 99999999) {
                wx.showToast({
                    title: '钱太多,数不过来啦',
                    icon: 'none'
                });
                return this.data.acount;
            }
            return value;
        },
        onRemarkFocus: function (e) {
            console.log(e);
            this.setData({
                typing: true
            });
        },
        onRemarkBlur: function (e) {
            var value = e.detail.value;
            this.setData({
                typing: false,
                remark: value
            });
        },
        onBillTypeTap: function (e) {
            var billTypeId = e.currentTarget.dataset.id;
            if (!billTypeId)
                return;
            this.setData({
                typing: false,
                form: __assign(__assign({}, this.data.form), { billTypeId: billTypeId })
            });
            wx.vibrateShort();
        },
        onImgBtnTap: function () {
            this.setData({
                imgPopupShow: true
            });
        },
        onImgPopupClose: function () {
            this.setData({
                imgPopupShow: false
            });
        },
        onAcountPopupClose: function () {
            this.setData({
                acountPopupShow: false
            });
        },
        onDatePopupClose: function () {
            this.setData({
                datePopupShow: false
            });
        },
        afterRead: function () {
        },
        onConfirm: function () {
            this.setData({
                datePopupShow: false
            });
        }
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia2V5Ym9hcmQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJrZXlib2FyZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFDQSxTQUFTLENBQUM7SUFDUixPQUFPLEVBQUU7UUFDUCxjQUFjLEVBQUUsY0FBYztLQUMvQjtJQUNELElBQUksRUFBRTtRQUNKLE9BQU8sRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxPQUFPLEVBQUU7UUFDNUUsT0FBTyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFO1FBQzdCLEdBQUcsRUFBRSxPQUFPO1FBQ1osR0FBRyxFQUFFLENBQUM7UUFDTixNQUFNLEVBQUUsRUFBRTtRQUNWLE1BQU0sRUFBRSxFQUFFO1FBQ1YsSUFBSSxFQUFFLEVBQUU7UUFDUixZQUFZLEVBQUUsS0FBSztRQUNuQixlQUFlLEVBQUUsS0FBSztRQUN0QixhQUFhLEVBQUUsS0FBSztRQUNwQixNQUFNLEVBQUUsS0FBSztRQUNiLE9BQU8sRUFBRSxDQUFDO1FBQ1YsSUFBSSxFQUFFO1lBQ0osVUFBVSxFQUFFLElBQUk7U0FDakI7UUFDRCxRQUFRLEVBQUUsRUFBRTtRQUNaLFNBQVMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDaEQsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUNyQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3JDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDckMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUNyQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3JDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDckMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUNyQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3JDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDckMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUN2QyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3ZDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDdkMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUN2QyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3ZDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsQ0FBQztLQUN6QztJQUNELE9BQU8sRUFBRTtR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LENBQUM7UUFDRCxrQkFBa0IsRUFBbEI7WUFDRSxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLGVBQWUsRUFBRSxLQUFLO2FBQ3ZCLENBQUMsQ0FBQTtRQUNKLENBQUM7UUFDRCxnQkFBZ0IsRUFBaEI7WUFDRSxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLGFBQWEsRUFBRSxLQUFLO2FBQ3JCLENBQUMsQ0FBQTtRQUNKLENBQUM7UUFDRCxTQUFTO1FBRVQsQ0FBQztRQUNELFNBQVM7WUFDUCxJQUFJLENBQUMsT0FBTyxDQUFDO2dCQUNYLGFBQWEsRUFBRSxLQUFLO2FBQ3JCLENBQUMsQ0FBQTtRQUNKLENBQUM7S0FDRjtDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5Db21wb25lbnQoe1xyXG4gIG9wdGlvbnM6IHtcclxuICAgIHN0eWxlSXNvbGF0aW9uOiAnYXBwbHktc2hhcmVkJ1xyXG4gIH0sXHJcbiAgZGF0YToge1xyXG4gICAgbWluRGF0ZTogbmV3IERhdGUobmV3IERhdGUoKS5nZXRUaW1lKCkgLSAxMDAwICogNjAgKiA2MCAqIDI0ICogMzApLmdldFRpbWUoKSxcclxuICAgIG1heERhdGU6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLFxyXG4gICAgbWF4OiA5OTk5OTk5LFxyXG4gICAgbWluOiAwLFxyXG4gICAgcmVtYXJrOiAnJyxcclxuICAgIGFjb3VudDogJycsXHJcbiAgICBkYXRlOiAnJyxcclxuICAgIGltZ1BvcHVwU2hvdzogZmFsc2UsXHJcbiAgICBhY291bnRQb3B1cFNob3c6IGZhbHNlLFxyXG4gICAgZGF0ZVBvcHVwU2hvdzogZmFsc2UsXHJcbiAgICB0eXBpbmc6IGZhbHNlLFxyXG4gICAgTWFpbkN1cjogMCxcclxuICAgIGZvcm06IHtcclxuICAgICAgYmlsbFR5cGVJZDogbnVsbFxyXG4gICAgfSxcclxuICAgIGZpbGVMaXN0OiBbXSxcclxuICAgIGJpbGxUeXBlczogW3sgaWQ6IDAsIG5hbWU6ICfotK3niaknLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogMSwgbmFtZTogJ+i0reeJqTEnLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogMiwgbmFtZTogJ+i0reeJqTInLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogMywgbmFtZTogJ+i0reeJqTMnLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogNCwgbmFtZTogJ+i0reeJqTQnLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogNSwgbmFtZTogJ+i0reeJqTUnLCBpY29uOiAnY2xvc2UnIH0sXHJcbiAgICB7IGlkOiA2LCBuYW1lOiAn6LSt54mpNicsIGljb246ICdjbG9zZScgfSwgXHJcbiAgICB7IGlkOiA3LCBuYW1lOiAn6LSt54mpNycsIGljb246ICdjbG9zZScgfSwgXHJcbiAgICB7IGlkOiA4LCBuYW1lOiAn6LSt54mpOCcsIGljb246ICdjbG9zZScgfSwgXHJcbiAgICB7IGlkOiA5LCBuYW1lOiAn6LSt54mpOScsIGljb246ICdjbG9zZScgfSwgXHJcbiAgICB7IGlkOiAxMCwgbmFtZTogJ+i0reeJqTEwJywgaWNvbjogJ2Nsb3NlJyB9LCBcclxuICAgIHsgaWQ6IDExLCBuYW1lOiAn6LSt54mpMTEnLCBpY29uOiAnY2xvc2UnIH0sXHJcbiAgICB7IGlkOiAxMiwgbmFtZTogJ+i0reeJqTEyJywgaWNvbjogJ2Nsb3NlJyB9LFxyXG4gICAgeyBpZDogMTMsIG5hbWU6ICfotK3niakxMycsIGljb246ICdjbG9zZScgfSxcclxuICAgIHsgaWQ6IDE0LCBuYW1lOiAn6LSt54mpMTQnLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogMTUsIG5hbWU6ICfotK3niakxNScsIGljb246ICdjbG9zZScgfV0sXHJcbiAgfSxcclxuICBtZXRob2RzOiB7XHJcbiAgICBvbklucHV0KGU6IGFueSk6IHZvaWR7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQudjtcclxuICAgICAgaWYoIXZhbHVlKSByZXR1cm5cclxuICAgICAgc3dpdGNoICh2YWx1ZSkge1xyXG4gICAgICAgIGNhc2UgJ2RhdGUnOlxyXG4gICAgICAgICAgdGhpcy5kYXRlKClcclxuICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIGNhc2UgJ2Fjb3VudCc6XHJcbiAgICAgICAgICB0aGlzLmFjb3VudCgpXHJcbiAgICAgICAgICByZXR1cm5cclxuICAgICAgICBjYXNlICdvayc6XHJcbiAgICAgICAgICB0aGlzLm9rKClcclxuICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIGNhc2UgJ2RlbCc6XHJcbiAgICAgICAgICB0aGlzLmRlbCgpXHJcbiAgICAgICAgICB3eC52aWJyYXRlU2hvcnQoKVxyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICB0aGlzLmlucHV0KHZhbHVlKVxyXG4gICAgICAgICAgd3gudmlicmF0ZVNob3J0KClcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGRlbCgpOiB2b2lke1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZGF0YS5hY291bnQuc3Vic3RyaW5nKDAsIHRoaXMuZGF0YS5hY291bnQubGVuZ3RoIC0gMSlcclxuICAgICAgY29uc29sZS5sb2coJ2RlbCcsdmFsdWUpXHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgYWNvdW50OiB2YWx1ZVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIGRhdGUoKTogdm9pZHtcclxuICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICBkYXRlUG9wdXBTaG93OiB0cnVlXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgb2soKTogdm9pZHtcclxuICAgICAgO1xyXG4gICAgfSxcclxuICAgIGFjb3VudCgpOiB2b2lke1xyXG4gICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgIGFjb3VudFBvcHVwU2hvdzogdHJ1ZVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIGlucHV0KHZhbDogc3RyaW5nKTogdm9pZHtcclxuICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmZvcm1hdCh2YWwpXHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgYWNvdW50OiB2YWx1ZVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIGZvcm1hdDogZnVuY3Rpb24gKHZhbDogYW55KSB7XHJcbiAgICAgIGlmICh0aGlzLmRhdGEuYWNvdW50LmluZGV4T2YoJy4nKSA+IC0xKSB7XHJcbiAgICAgICAgaWYgKHZhbCA9PT0gJy4nKXtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEuYWNvdW50XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKHRoaXMuZGF0YS5hY291bnQuc3BsaXQoJy4nKVsxXS5sZW5ndGggPj0gMil7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmFjb3VudFxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZGF0YS5hY291bnQgKyB2YWxcclxuICAgICAgaWYgKHZhbCA9PT0gJy4nKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5hY291bnQgKyB2YWxcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5kYXRhLmFjb3VudCA9PT0gJzAnKXtcclxuICAgICAgICBpZih2YWwgIT09ICcuJyApe1xyXG4gICAgICAgICAgcmV0dXJuIHZhbFxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBpZihwYXJzZUludCh2YWx1ZSkgPiA5OTk5OTk5OSl7XHJcbiAgICAgICAgd3guc2hvd1RvYXN0KHtcclxuICAgICAgICAgIHRpdGxlOiAn6ZKx5aSq5aSaLOaVsOS4jei/h+adpeWVpicsXHJcbiAgICAgICAgICBpY29uOiAnbm9uZSdcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuYWNvdW50XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB2YWx1ZVxyXG5cclxuICAgIH0sXHJcbiAgICBvblJlbWFya0ZvY3VzKGU6IGFueSk6IHZvaWQge1xyXG4gICAgICBjb25zb2xlLmxvZyhlKVxyXG4gICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgIHR5cGluZzogdHJ1ZVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIG9uUmVtYXJrQmx1cihlOiBhbnkpOiB2b2lkIHtcclxuICAgICAgY29uc3QgdmFsdWUgPSBlLmRldGFpbC52YWx1ZVxyXG4gICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgIHR5cGluZzogZmFsc2UsXHJcbiAgICAgICAgcmVtYXJrOiB2YWx1ZVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIG9uQmlsbFR5cGVUYXAoZTogYW55KTogdm9pZCB7XHJcbiAgICAgIGNvbnN0IGJpbGxUeXBlSWQgPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5pZDtcclxuICAgICAgaWYoIWJpbGxUeXBlSWQpIHJldHVyblxyXG4gICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgIHR5cGluZzogZmFsc2UsXHJcbiAgICAgICAgZm9ybToge1xyXG4gICAgICAgICAgLi4udGhpcy5kYXRhLmZvcm0sXHJcbiAgICAgICAgICBiaWxsVHlwZUlkXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICB3eC52aWJyYXRlU2hvcnQoKVxyXG4gICAgfSxcclxuICAgIG9uSW1nQnRuVGFwKCk6IHZvaWR7XHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgaW1nUG9wdXBTaG93OiB0cnVlXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgb25JbWdQb3B1cENsb3NlKCk6IHZvaWR7XHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgaW1nUG9wdXBTaG93OiBmYWxzZVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIG9uQWNvdW50UG9wdXBDbG9zZSgpOiB2b2lke1xyXG4gICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgIGFjb3VudFBvcHVwU2hvdzogZmFsc2VcclxuICAgICAgfSlcclxuICAgIH0sXHJcbiAgICBvbkRhdGVQb3B1cENsb3NlKCk6IHZvaWR7XHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgZGF0ZVBvcHVwU2hvdzogZmFsc2VcclxuICAgICAgfSlcclxuICAgIH0sXHJcbiAgICBhZnRlclJlYWQoKXtcclxuXHJcbiAgICB9LFxyXG4gICAgb25Db25maXJtKCl7XHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgZGF0ZVBvcHVwU2hvdzogZmFsc2VcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcbn0pIl19