"use strict";
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
Component({
    options: {
        styleIsolation: 'apply-shared'
    },
    lifetimes: {
        attached: function () {
            console.log('attached');
        }
    },
    data: {
        minDate: new Date(new Date().getTime() - 1000 * 60 * 60 * 24 * 30).getTime(),
        maxDate: new Date().getTime(),
        max: 9999999,
        min: 0,
        remark: '',
        acount: '',
        date: '',
        imgPopupShow: false,
        acountPopupShow: false,
        datePopupShow: false,
        typing: false,
        MainCur: 0,
        form: {
            billTypeId: null
        },
        fileList: [],
        billTypes: [{ id: 0, name: '购物', icon: 'close' },
            { id: 1, name: '购物1', icon: 'close' },
            { id: 2, name: '购物2', icon: 'close' },
            { id: 3, name: '购物3', icon: 'close' },
            { id: 4, name: '购物4', icon: 'close' },
            { id: 5, name: '购物5', icon: 'close' },
            { id: 6, name: '购物6', icon: 'close' },
            { id: 7, name: '购物7', icon: 'close' },
            { id: 8, name: '购物8', icon: 'close' },
            { id: 9, name: '购物9', icon: 'close' },
            { id: 10, name: '购物10', icon: 'close' },
            { id: 11, name: '购物11', icon: 'close' },
            { id: 12, name: '购物12', icon: 'close' },
            { id: 13, name: '购物13', icon: 'close' },
            { id: 14, name: '购物14', icon: 'close' },
            { id: 15, name: '购物15', icon: 'close' }],
    },
    methods: {
        onLoad: function () {
            console.log('load');
        },
        onInput: function (e) {
            var value = e.currentTarget.dataset.v;
            if (!value)
                return;
            switch (value) {
                case 'date':
                    this.date();
                    return;
                case 'acount':
                    this.acount();
                    return;
                case 'ok':
                    this.ok();
                    return;
                case 'del':
                    this.del();
                    wx.vibrateShort();
                    return;
                default:
                    this.input(value);
                    wx.vibrateShort();
                    return;
            }
        },
        del: function () {
            var value = this.data.acount.substring(0, this.data.acount.length - 1);
            this.setData({
                acount: value
            });
        },
        date: function () {
            this.setData({
                datePopupShow: true
            });
        },
        ok: function () {
            ;
        },
        acount: function () {
            this.setData({
                acountPopupShow: true
            });
        },
        input: function (val) {
            var value = this.format(val);
            this.setData({
                acount: value
            });
        },
        format: function (val) {
            if (this.data.acount.indexOf('.') > -1) {
                if (val === '.') {
                    return this.data.acount;
                }
                if (this.data.acount.split('.')[1].length >= 2) {
                    return this.data.acount;
                }
            }
            var value = this.data.acount + val;
            if (val === '.') {
                return this.data.acount + val;
            }
            if (this.data.acount === '0') {
                if (val !== '.') {
                    return val;
                }
            }
            if (parseInt(value) > 99999999) {
                wx.showToast({
                    title: '钱太多,数不过来啦',
                    icon: 'none'
                });
                return this.data.acount;
            }
            return value;
        },
        onRemarkFocus: function () {
            this.setData({
                typing: true
            });
        },
        onRemarkBlur: function (e) {
            var value = e.detail.value;
            this.setData({
                typing: false,
                remark: value
            });
        },
        onBillTypeTap: function (e) {
            var billTypeId = e.currentTarget.dataset.id;
            if (!billTypeId)
                return;
            this.setData({
                typing: false,
                form: __assign(__assign({}, this.data.form), { billTypeId: billTypeId })
            });
            wx.vibrateShort();
        },
        onImgBtnTap: function () {
            this.setData({
                imgPopupShow: true
            });
        },
        onImgPopupClose: function () {
            this.setData({
                imgPopupShow: false
            });
        },
        onAcountPopupClose: function () {
            this.setData({
                acountPopupShow: false
            });
        },
        onDatePopupClose: function () {
            this.setData({
                datePopupShow: false
            });
        },
        afterRead: function () {
        },
        onConfirm: function () {
            this.setData({
                datePopupShow: false
            });
        }
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia2V5Ym9hcmQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJrZXlib2FyZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFDQSxTQUFTLENBQUM7SUFDUixPQUFPLEVBQUU7UUFDUCxjQUFjLEVBQUUsY0FBYztLQUMvQjtJQUNELFNBQVMsRUFBRTtRQUNULFFBQVE7WUFDTixPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFBO1FBQ3pCLENBQUM7S0FDRjtJQUNELElBQUksRUFBRTtRQUNKLE9BQU8sRUFBRSxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLElBQUksR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxPQUFPLEVBQUU7UUFDNUUsT0FBTyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFO1FBQzdCLEdBQUcsRUFBRSxPQUFPO1FBQ1osR0FBRyxFQUFFLENBQUM7UUFDTixNQUFNLEVBQUUsRUFBRTtRQUNWLE1BQU0sRUFBRSxFQUFFO1FBQ1YsSUFBSSxFQUFFLEVBQUU7UUFDUixZQUFZLEVBQUUsS0FBSztRQUNuQixlQUFlLEVBQUUsS0FBSztRQUN0QixhQUFhLEVBQUUsS0FBSztRQUNwQixNQUFNLEVBQUUsS0FBSztRQUNiLE9BQU8sRUFBRSxDQUFDO1FBQ1YsSUFBSSxFQUFFO1lBQ0osVUFBVSxFQUFFLElBQUk7U0FDakI7UUFDRCxRQUFRLEVBQUUsRUFBRTtRQUNaLFNBQVMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDaEQsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUNyQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3JDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDckMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUNyQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3JDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDckMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUNyQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3JDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDckMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUN2QyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3ZDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUU7WUFDdkMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRTtZQUN2QyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFO1lBQ3ZDLEVBQUUsRUFBRSxF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QkFDWCxZQUFZLEVBQUUsS0FBSzthQUNwQixDQUFDLENBQUE7UUFDSixDQUFDO1FBQ0Qsa0JBQWtCLEVBQWxCO1lBQ0UsSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDWCxlQUFlLEVBQUUsS0FBSzthQUN2QixDQUFDLENBQUE7UUFDSixDQUFDO1FBQ0QsZ0JBQWdCLEVBQWhCO1lBQ0UsSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDWCxhQUFhLEVBQUUsS0FBSzthQUNyQixDQUFDLENBQUE7UUFDSixDQUFDO1FBQ0QsU0FBUztRQUVULENBQUM7UUFDRCxTQUFTO1lBQ1AsSUFBSSxDQUFDLE9BQU8sQ0FBQztnQkFDWCxhQUFhLEVBQUUsS0FBSzthQUNyQixDQUFDLENBQUE7UUFDSixDQUFDO0tBQ0Y7Q0FDRixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuQ29tcG9uZW50KHtcclxuICBvcHRpb25zOiB7XHJcbiAgICBzdHlsZUlzb2xhdGlvbjogJ2FwcGx5LXNoYXJlZCdcclxuICB9LFxyXG4gIGxpZmV0aW1lczoge1xyXG4gICAgYXR0YWNoZWQoKXtcclxuICAgICAgY29uc29sZS5sb2coJ2F0dGFjaGVkJylcclxuICAgIH1cclxuICB9LFxyXG4gIGRhdGE6IHtcclxuICAgIG1pbkRhdGU6IG5ldyBEYXRlKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gMTAwMCAqIDYwICogNjAgKiAyNCAqIDMwKS5nZXRUaW1lKCksXHJcbiAgICBtYXhEYXRlOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSxcclxuICAgIG1heDogOTk5OTk5OSxcclxuICAgIG1pbjogMCxcclxuICAgIHJlbWFyazogJycsXHJcbiAgICBhY291bnQ6ICcnLFxyXG4gICAgZGF0ZTogJycsXHJcbiAgICBpbWdQb3B1cFNob3c6IGZhbHNlLFxyXG4gICAgYWNvdW50UG9wdXBTaG93OiBmYWxzZSxcclxuICAgIGRhdGVQb3B1cFNob3c6IGZhbHNlLFxyXG4gICAgdHlwaW5nOiBmYWxzZSxcclxuICAgIE1haW5DdXI6IDAsXHJcbiAgICBmb3JtOiB7XHJcbiAgICAgIGJpbGxUeXBlSWQ6IG51bGxcclxuICAgIH0sXHJcbiAgICBmaWxlTGlzdDogW10sXHJcbiAgICBiaWxsVHlwZXM6IFt7IGlkOiAwLCBuYW1lOiAn6LSt54mpJywgaWNvbjogJ2Nsb3NlJyB9LCBcclxuICAgIHsgaWQ6IDEsIG5hbWU6ICfotK3niakxJywgaWNvbjogJ2Nsb3NlJyB9LCBcclxuICAgIHsgaWQ6IDIsIG5hbWU6ICfotK3niakyJywgaWNvbjogJ2Nsb3NlJyB9LCBcclxuICAgIHsgaWQ6IDMsIG5hbWU6ICfotK3niakzJywgaWNvbjogJ2Nsb3NlJyB9LCBcclxuICAgIHsgaWQ6IDQsIG5hbWU6ICfotK3niak0JywgaWNvbjogJ2Nsb3NlJyB9LCBcclxuICAgIHsgaWQ6IDUsIG5hbWU6ICfotK3niak1JywgaWNvbjogJ2Nsb3NlJyB9LFxyXG4gICAgeyBpZDogNiwgbmFtZTogJ+i0reeJqTYnLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogNywgbmFtZTogJ+i0reeJqTcnLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogOCwgbmFtZTogJ+i0reeJqTgnLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogOSwgbmFtZTogJ+i0reeJqTknLCBpY29uOiAnY2xvc2UnIH0sIFxyXG4gICAgeyBpZDogMTAsIG5hbWU6ICfotK3niakxMCcsIGljb246ICdjbG9zZScgfSwgXHJcbiAgICB7IGlkOiAxMSwgbmFtZTogJ+i0reeJqTExJywgaWNvbjogJ2Nsb3NlJyB9LFxyXG4gICAgeyBpZDogMTIsIG5hbWU6ICfotK3niakxMicsIGljb246ICdjbG9zZScgfSxcclxuICAgIHsgaWQ6IDEzLCBuYW1lOiAn6LSt54mpMTMnLCBpY29uOiAnY2xvc2UnIH0sXHJcbiAgICB7IGlkOiAxNCwgbmFtZTogJ+i0reeJqTE0JywgaWNvbjogJ2Nsb3NlJyB9LCBcclxuICAgIHsgaWQ6IDE1LCBuYW1lOiAn6LSt54mpMTUnLCBpY29uOiAnY2xvc2UnIH1dLFxyXG4gIH0sXHJcbiAgbWV0aG9kczoge1xyXG4gICAgb25Mb2FkKCl7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdsb2FkJylcclxuICAgIH0sXHJcbiAgICBvbklucHV0KGU6IGFueSk6IHZvaWR7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQudjtcclxuICAgICAgaWYoIXZhbHVlKSByZXR1cm5cclxuICAgICAgc3dpdGNoICh2YWx1ZSkge1xyXG4gICAgICAgIGNhc2UgJ2RhdGUnOlxyXG4gICAgICAgICAgdGhpcy5kYXRlKClcclxuICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIGNhc2UgJ2Fjb3VudCc6XHJcbiAgICAgICAgICB0aGlzLmFjb3VudCgpXHJcbiAgICAgICAgICByZXR1cm5cclxuICAgICAgICBjYXNlICdvayc6XHJcbiAgICAgICAgICB0aGlzLm9rKClcclxuICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIGNhc2UgJ2RlbCc6XHJcbiAgICAgICAgICB0aGlzLmRlbCgpXHJcbiAgICAgICAgICB3eC52aWJyYXRlU2hvcnQoKVxyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICB0aGlzLmlucHV0KHZhbHVlKVxyXG4gICAgICAgICAgd3gudmlicmF0ZVNob3J0KClcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIGRlbCgpOiB2b2lke1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZGF0YS5hY291bnQuc3Vic3RyaW5nKDAsIHRoaXMuZGF0YS5hY291bnQubGVuZ3RoIC0gMSlcclxuICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICBhY291bnQ6IHZhbHVlXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgZGF0ZSgpOiB2b2lke1xyXG4gICAgICB0aGlzLnNldERhdGEoe1xyXG4gICAgICAgIGRhdGVQb3B1cFNob3c6IHRydWVcclxuICAgICAgfSlcclxuICAgIH0sXHJcbiAgICBvaygpOiB2b2lke1xyXG4gICAgICA7XHJcbiAgICB9LFxyXG4gICAgYWNvdW50KCk6IHZvaWR7XHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgYWNvdW50UG9wdXBTaG93OiB0cnVlXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgaW5wdXQodmFsOiBzdHJpbmcpOiB2b2lke1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZm9ybWF0KHZhbClcclxuICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICBhY291bnQ6IHZhbHVlXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgZm9ybWF0OiBmdW5jdGlvbiAodmFsOiBhbnkpIHtcclxuICAgICAgaWYgKHRoaXMuZGF0YS5hY291bnQuaW5kZXhPZignLicpID4gLTEpIHtcclxuICAgICAgICBpZiAodmFsID09PSAnLicpe1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5hY291bnRcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5kYXRhLmFjb3VudC5zcGxpdCgnLicpWzFdLmxlbmd0aCA+PSAyKXtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEuYWNvdW50XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5kYXRhLmFjb3VudCArIHZhbFxyXG4gICAgICBpZiAodmFsID09PSAnLicpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhLmFjb3VudCArIHZhbFxyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmRhdGEuYWNvdW50ID09PSAnMCcpe1xyXG4gICAgICAgIGlmKHZhbCAhPT0gJy4nICl7XHJcbiAgICAgICAgICByZXR1cm4gdmFsXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmKHBhcnNlSW50KHZhbHVlKSA+IDk5OTk5OTk5KXtcclxuICAgICAgICB3eC5zaG93VG9hc3Qoe1xyXG4gICAgICAgICAgdGl0bGU6ICfpkrHlpKrlpJos5pWw5LiN6L+H5p2l5ZWmJyxcclxuICAgICAgICAgIGljb246ICdub25lJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5hY291bnRcclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHZhbHVlXHJcblxyXG4gICAgfSxcclxuICAgIG9uUmVtYXJrRm9jdXMoKTogdm9pZCB7XHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgdHlwaW5nOiB0cnVlXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgb25SZW1hcmtCbHVyKGU6IGFueSk6IHZvaWQge1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IGUuZGV0YWlsLnZhbHVlXHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgdHlwaW5nOiBmYWxzZSxcclxuICAgICAgICByZW1hcms6IHZhbHVlXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgb25CaWxsVHlwZVRhcChlOiBhbnkpOiB2b2lkIHtcclxuICAgICAgY29uc3QgYmlsbFR5cGVJZCA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmlkO1xyXG4gICAgICBpZighYmlsbFR5cGVJZCkgcmV0dXJuXHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgdHlwaW5nOiBmYWxzZSxcclxuICAgICAgICBmb3JtOiB7XHJcbiAgICAgICAgICAuLi50aGlzLmRhdGEuZm9ybSxcclxuICAgICAgICAgIGJpbGxUeXBlSWRcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIHd4LnZpYnJhdGVTaG9ydCgpXHJcbiAgICB9LFxyXG4gICAgb25JbWdCdG5UYXAoKTogdm9pZHtcclxuICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICBpbWdQb3B1cFNob3c6IHRydWVcclxuICAgICAgfSlcclxuICAgIH0sXHJcbiAgICBvbkltZ1BvcHVwQ2xvc2UoKTogdm9pZHtcclxuICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICBpbWdQb3B1cFNob3c6IGZhbHNlXHJcbiAgICAgIH0pXHJcbiAgICB9LFxyXG4gICAgb25BY291bnRQb3B1cENsb3NlKCk6IHZvaWR7XHJcbiAgICAgIHRoaXMuc2V0RGF0YSh7XHJcbiAgICAgICAgYWNvdW50UG9wdXBTaG93OiBmYWxzZVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIG9uRGF0ZVBvcHVwQ2xvc2UoKTogdm9pZHtcclxuICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICBkYXRlUG9wdXBTaG93OiBmYWxzZVxyXG4gICAgICB9KVxyXG4gICAgfSxcclxuICAgIGFmdGVyUmVhZCgpe1xyXG5cclxuICAgIH0sXHJcbiAgICBvbkNvbmZpcm0oKXtcclxuICAgICAgdGhpcy5zZXREYXRhKHtcclxuICAgICAgICBkYXRlUG9wdXBTaG93OiBmYWxzZVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxufSkiXX0=